<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Combined Tool — Doc Extractor + Slug/Image/MD</title>
<style>
:root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#06b6d4;--white:#e6eef6;}
*{box-sizing:border-box;}
body{margin:20px;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:linear-gradient(180deg,#07101a 0%,#0b1220 100%);color:var(--white);}
.grid-main{display:flex;gap:20px;flex-wrap:wrap;}
.half{flex:1 1 48%;background:rgba(255,255,255,0.02);padding:20px;border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.7);min-width:300px;}
h1{font-size:20px;margin:0 0 12px;}
p.note{color:var(--muted);margin:0 0 18px;}
textarea,div.content-editable, #editor,#output,#outputArea,#mdOutput{width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--white);resize:none;overflow-y:hidden;}
textarea{min-height:120px;}
.controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;margin-bottom:10px;}
button{background:var(--accent);border:none;color:#022;padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:600;}
button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--white);}
button.small{font-size:13px;padding:8px 10px;}
.result{white-space:pre-wrap;word-break:break-word;background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;border:1px dashed rgba(255,255,255,0.04);min-height:120px;color:var(--white);}
.footer{margin-top:14px;color:var(--muted);font-size:13px;}
label{font-size:13px;color:var(--muted);}
@media(max-width:880px){.grid-main{flex-direction:column;}}
</style>
</head>
<body>

<div class="grid-main">
  <!-- Nửa trái: Doc Extractor -->
  <div class="half">
    <h1>Doc Extractor Tool</h1>
    <p class="note">Paste nội dung Google Docs vào dưới đây:</p>
    <div id="editor" contenteditable="true" style="min-height:80px;"></div>

    <div class="controls">
      <label><input type="checkbox" id="extractH2" checked> Trích xuất H2</label>
      <label style="margin-left:10px;">Số lượng H2: <input type="number" id="h2Limit" value="0" min="0" style="width:50px;"></label>
      <label style="margin-left:10px;"><input type="checkbox" id="randomH2"> Random H2</label>
      <label style="margin-left:10px;">Xuất dạng:
        <select id="outputType">
          <option value="alt">H1 + Alt</option>
          <option value="h2">H1 + H2</option>
        </select>
      </label>
    </div>

    <button onclick="runExtract()">Trích xuất</button>
    <div id="output" contenteditable="true"></div>
    <div class="footer">code by @chenchenhuang</div>
  </div>

  <!-- Nửa phải: Slug & Image Converter + MD Generator -->
  <div class="half">
    <h1>Slug Converter — chuyển tiêu đề → slug</h1>
    <p class="note">Dán tiêu đề (mỗi dòng 1 tiêu đề). Hệ thống sẽ chuyển thành slug chuẩn SEO.</p>
    <textarea id="inputText" placeholder="Ví dụ: Liên Hệ SV388"></textarea>
    <div class="controls">
      <button id="convertBtn">Chuyển đổi</button>
      <button id="convertMapBtn" class="ghost">Chuyển (đầu vào → slug)</button>
      <button id="clearBtn" class="ghost small">Xóa</button>
      <button id="pasteBtn" class="ghost small">Dán từ clipboard</button>
    </div>
    <div class="controls">
      <input type="checkbox" id="trimDuplicates" /><label for="trimDuplicates">loại trùng</label>
      <input type="checkbox" id="allowNumbers" checked style="margin-left:10px;" /><label for="allowNumbers">giữ chữ số</label>
    </div>
    <div id="outputArea" class="result" contenteditable="true"></div>

    <h1 style="margin-top:20px;">MD Generator</h1>
    <p class="note">(Để tạo folder nhanh: nhập danh sách → xuất file .bat)</p>
    <div class="controls">
      <label><input type="radio" name="mode" value="auto" checked> Tự đánh STT</label>
      <label><input type="radio" name="mode" value="manual"> Giữ nguyên </label>
    </div>
    <textarea id="mdInput" placeholder="Ví dụ: Bắn cá Đá gà Bóng đá"></textarea>
    <div class="controls">
      <button onclick="convertMD()">Chuyển đổi</button>
      <button onclick="downloadBat()" class="ghost">Tải .bat</button>
    </div>
    <div id="mdOutput" class="result" contenteditable="true"></div>

    <div class="footer">code by @chenchenhuang</div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script>
// ===== Doc Extractor JS =====
function shuffleArray(array){const arr=array.slice();for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}
function extractAlt(){const editor=document.getElementById('editor');const altList=[];editor.querySelectorAll('p, div, li, h2, h3').forEach(block=>{let hasItalic=false;block.querySelectorAll('*').forEach(n=>{if(window.getComputedStyle(n).fontStyle==='italic')hasItalic=true;});if(hasItalic)altList.push(block.innerText.trim());});return altList;}
function extractContent(options){const editor=document.getElementById('editor');let h1Text='';const h1=editor.querySelector('h1');if(h1)h1Text=h1.innerText.trim();else{const strongs=Array.from(editor.querySelectorAll('strong,b'));if(strongs.length>0)h1Text=strongs[0].innerText.trim();}let h2TextList=[];if(options.extractH2){let temp=Array.from(editor.querySelectorAll('h2')).map(el=>el.innerText.trim());if(options.h2Limit>0)temp=options.randomH2?shuffleArray(temp).slice(0,options.h2Limit):temp.slice(0,options.h2Limit);h2TextList=temp;}const altList=extractAlt();return {h1:h1Text,h2:h2TextList,alt:altList};}
function runExtract(){const options={extractH2:document.getElementById('extractH2').checked,h2Limit:parseInt(document.getElementById('h2Limit').value),randomH2:document.getElementById('randomH2').checked};const result=extractContent(options);const type=document.getElementById('outputType').value;let outputHtml='<div>'+result.h1+'</div>';if(type==='alt'){result.alt.forEach(a=>outputHtml+='<div>'+a+'</div>');}else if(type==='h2'){result.h2.forEach(h=>outputHtml+='<div>'+h+'</div>');}document.getElementById('output').innerHTML=outputHtml;autoResize(document.getElementById('output'));}
function autoResize(el){el.style.height='50px';el.style.height=el.scrollHeight+'px';}
document.getElementById('editor').addEventListener('input',()=>autoResize(document.getElementById('editor')));
document.getElementById('output').addEventListener('input',()=>autoResize(document.getElementById('output')));
window.addEventListener('load',()=>{autoResize(document.getElementById('editor'));autoResize(document.getElementById('output'));});

// ===== Slug Converter JS =====
function toSlugSingle(text,options={keepNumbers:true}){if(typeof text!=='string')return'';let s=text.trim().toLowerCase();const from="àáạảãâầấậẩẫăằắặẳẵèéẹẻẽêềếệểễìíịỉĩòóọỏõôồốộổỗơờớợởỡùúụủũưừứựửữỳýỵỷỹđ";const to="aaaaaaaaaaaaaaaaaeeeeeeeeeeeiiiiiooooooooooooooooouuuuuuuuuuuyyyyyd";let r="";for(let i=0;i<s.length;i++){const idx=from.indexOf(s[i]);r+=(idx>-1?to[idx]:s[i]);}if(!options.keepNumbers)r=r.replace(/[^a-z\s-]/g,'');else r=r.replace(/[^a-z0-9\s-]/g,'');r=r.replace(/[\s\-]+/g,'-').replace(/^\-+|\-+$/g,'');return r;}
function convertMulti(text,config){const lines=text.split(/\r?\n/).map(l=>l.trim()).filter(l=>l.length>0);const seen=new Set();const out=[];for(let original of lines){const slug=toSlugSingle(original,{keepNumbers:config.keepNumbers});if(config.trimDuplicates){if(seen.has(slug))continue;seen.add(slug);}if(config.mode==='map')out.push(`${original} -> ${slug}`);else out.push(slug);}return config.mode==='inline'?out.join(', '):out.join('\n');}
const inputText=document.getElementById('inputText');const outputArea=document.getElementById('outputArea');const convertBtn=document.getElementById('convertBtn');const convertMapBtn=document.getElementById('convertMapBtn');const copyBtn=document.createElement('button');const downloadBtn=document.createElement('button');const clearBtn=document.getElementById('clearBtn');const clearOutBtn=document.createElement('button');const modeSelect=document.createElement('select');const trimDuplicates=document.getElementById('trimDuplicates');const allowNumbers=document.getElementById('allowNumbers');const pasteBtn=document.getElementById('pasteBtn');
function doConvert(modeOption){const mode=modeOption||'plain';const config={mode,trimDuplicates:trimDuplicates.checked,keepNumbers:allowNumbers.checked};const input=inputText.value;if(!input.trim()){outputArea.textContent='';return;}outputArea.textContent=convertMulti(input,config);}
convertBtn.onclick=()=>doConvert('plain');convertMapBtn.onclick=()=>doConvert('map');inputText.addEventListener('input',()=>{clearTimeout(window.typingTimer);window.typingTimer=setTimeout(()=>doConvert(),400);});

// ===== MD Generator JS =====
function removeDiacritics(str){return str.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D");}
function convertMD(){const input=document.getElementById("mdInput").value.trim().split("\n");const mode=document.querySelector('input[name="mode"]:checked').value;let result=[];input.forEach((line,i)=>{let clean=removeDiacritics(line).toLowerCase().trim().replace(/\s+/g," ");if(!clean)return;if(mode==="auto")result.push(`md ${i+1} ${clean}`);else result.push(`md ${clean}`);});document.getElementById("mdOutput").textContent=result.join("\n");}
function downloadBat(){const content=document.getElementById("mdOutput").textContent;if(!content.trim()){alert("Chưa có nội dung!");return;}const blob=new Blob([content],{type:"text/plain;charset=utf-8"});const url=URL.createObjectURL(blob);const a=document.createElement("a");a.href=url;a.download="tao_folder.bat";a.click();URL.revokeObjectURL(url);}
</script>

</body>
</html>
